# 2.1.8. 文件库

为本地文件系统定义的操作分为两部分。所有本地文件系统的共同点是分层命名、锁定、配额、属性管理和保护。这些功能与数据的存储方式无关。4.4BSD 有一个单一的实现来提供这些语义。

本地文件系统的另一部分是对存储介质上的数据进行组织和管理。铺设存储介质上的文件内容是文件库的责任。4.4BSD 支持三种不同的文件存储布局。

- 传统的伯克利快速文件系统
- 日志结构的文件系统，基于 Sprite 操作系统设计[[Rosenblum & Ousterhout, 1992/]](https://docs.freebsd.org/en/books/design-44bsd/#biblio-rosenblum)
- 一个基于内存的文件系统

尽管这些文件库的组织完全不同，但对于使用这些文件库的进程来说，这些差异是无法区分的。

快速文件系统将数据组织成圆柱体组。根据它们在文件系统层次结构中的位置，可能被一起访问的文件被存储在同一个圆柱体组中。预计不会被一起访问的文件被移到不同的圆柱体组中。因此，在同一时间写入的文件可能会在磁盘上相隔很远。

日志结构的文件系统将数据组织成一个日志。在任何时间点被写入的所有数据都聚集在一起，并被写入同一个磁盘位置。数据永远不会被覆盖；相反，一个新的文件副本被写入，取代了旧的文件。当文件系统变满，需要额外的自由空间时，旧的文件被一个垃圾收集过程所回收。

基于内存的文件系统被设计为在虚拟内存中存储数据。它被用于需要支持快速但临时数据的文件系统，如/tmp。基于内存的文件系统的目标是使存储尽可能地紧凑，以尽量减少对虚拟内存资源的使用。
