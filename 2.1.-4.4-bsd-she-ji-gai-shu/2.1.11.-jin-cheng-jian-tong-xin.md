# 2.1.11. 进程间通信

4.4BSD 的进程间通信是在通信域中组织的。目前支持的域包括本地域，用于在同一台机器上执行的进程之间的通信；互联网域，用于使用 TCP/IP 协议套件的进程之间的通信（也许是在互联网内）；ISO/OSI 协议族，用于运行它们所需的站点之间的通信；以及X NS 域，用于使用 XEROX 网络系统（XNS）协议的进程之间的通信。

在一个域内，通信是在被称为套接字的通信端点之间进行的。如第 2.6 节所述，套接字系统调用创建一个套接字并返回一个描述符；其他 IPC 系统调用将在第11章中描述。每个套接字都有一个定义其通信语义的类型；这些语义包括诸如可靠性、排序和防止消息重复的属性。

每个套接字都有一个与之相关的通信协议。该协议根据套接字的类型提供套接字所需的语义。应用程序可以在创建一个套接字时要求一个特定的协议，也可以让系统选择一个适合所创建的套接字类型的协议。

套接字可以有绑定的地址。套接字地址的形式和意义取决于创建套接字的通信域。在本地域中，将一个名字绑定到一个套接字上会导致在文件系统中创建一个文件。

通过套接字传输和接收的正常数据是没有类型的。数据表示的问题是建立在进程间通信设施之上的库的责任。除了传输正常数据外，通信域还可以支持传输和接收特殊类型的数据，称为访问权。例如，本地域使用这种设施在进程之间传递描述符。

在 4.2BSD 之前，UNIX 上的网络实现通常通过重载字符设备接口来实现。套接字接口的一个目标是让天真的程序能够在不改变流式连接的情况下工作。这些程序只有在读写系统调用不变的情况下才能工作。因此，原来的接口被完整地保留下来，并使之在流式套接字上工作。一个新的接口被添加到更复杂的套接字上，比如那些用于发送数据包的套接字，在每次发送调用时必须提供一个目标地址。

另一个好处是，新的接口具有高度的可移植性。在伯克利发布测试版后不久，套接字接口就被一家 UNIX 厂商移植到了 System III 上（尽管 AT&T 直到 System V Release 4 发布时才支持套接字接口，而是决定使用第八版流机制）。套接字接口也被供应商移植到了许多以太网板上，如 Excelan 和 Interlan ，这些供应商正在向 PC 市场销售，这些机器太小，无法在主处理器中运行网络。最近，套接字接口被用作微软 Windows 的 Winsock 网络接口的基础。
