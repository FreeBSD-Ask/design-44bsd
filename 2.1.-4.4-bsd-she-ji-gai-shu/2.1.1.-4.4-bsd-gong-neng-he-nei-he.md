# 2.1.1. 4.4BSD设施和内核

4.4BSD 内核提供了四个基本功能：进程、文件系统、通信和系统启动。本节概述了这四种基本服务在本书中的论述：

1.进程构成了一个地址空间中的控制线程。第四章描述了创建、终止和其他控制进程的机制。系统为每个进程复用不同的虚拟地址空间，这种内存管理将在第 5 章讨论。

2.文件系统和设备的用户界面是相似的；共同的方面在第 6 章讨论。文件系统是一组命名的文件，组织在目录的树状结构层次中，以及操作它们的操作，如第七章所述。文件驻留在物理介质上，如磁盘。4.4BSD 支持几种磁盘上的数据组织，如第八章所述。访问远程机器上的文件是第九章的主题。终端机是用来访问系统的；它们的操作是第10章的主题。

3.传统 UNIX 系统提供的通信机制包括相关进程之间的简单可靠的字节流（见管道，第 11.1 节），以及特殊事件的通知（见信号，第 4.7 节）。4.4BSD 也有一个通用的进程间通信设施。这个设施，在第11章中描述，使用与文件系统不同的访问机制，但是，只要建立了连接，一个进程就可以像使用管道一样访问它。有一个一般的网络框架，在第12章中讨论，它通常被用作 IPC 设施的底层。第13章详细描述了一个特定的网络实现。

3.任何真正的操作系统都有操作问题，例如如何启动运行。启动和运行问题将在第 14 章描述。

第 2.3 节到第 2.14 节是与第 3 章到第 14 章有关的介绍性材料。我们将定义术语，提到基本的系统调用，并探讨历史发展。最后，我们将给出许多主要设计原则的原因。

## 2.1.1.1. 内核

内核在系统中以保护模式运行，它调解所有用户程序对底层硬件（如 CPU、磁盘、终端、网络链接）和软件结构（如文件系统、网络协议）的访问。内核提供基本的系统功能；它创建和管理进程，并提供访问文件系统和通信设施。这些功能被称为系统调用，对用户进程来说是库中的子程序。这些系统调用是进程访问这些设施的唯一接口。第3章给出了系统调用机制的细节，同时也描述了几个内核机制，这些机制的执行并不是进程进行系统调用的直接结果。

在传统的操作系统术语中，内核是一个小的软件核心，它只提供实现额外的操作系统服务所需的最小设施。在当代研究型操作系统中--比如 Chorus[Rozier等人，1988]，Mach[Accetta等人，1986]，Tunis[Ewens等人，1985]，以及 V 内核[Cheriton，1988]--这种功能的划分不仅仅是逻辑上的。诸如文件系统和网络协议等服务是作为核心或内核的客户应用进程来实现的。

4.4BSD 的内核没有被分割成多个进程。这个基本的设计决定是在最早的 UNIX 版本中做出的。Ken Thompson 的前两个实现没有内存映射，因此在用户和内核空间之间没有硬件强制的区分[Ritchie, 1988]。一个消息传递系统可以像实际实现的内核和用户进程的模型一样容易实现。单一的内核是为了简单和性能而选择的。早期的内核很小；而将网络等设施纳入内核后，内核的规模增大了。目前操作系统研究的趋势是通过将这些服务放在用户空间来减少内核的大小。

用户通常通过一个被称为 shell 的命令语言解释器，以及可能通过额外的用户应用程序与系统进行交互。这些程序和 shell 是通过进程实现的。这类程序的细节超出了本书的范围，而本书几乎只集中在内核上。

第 2.3 和 2.4 节描述了 4.4BSD 内核提供的服务，并对后者的设计进行了概述。后面的章节描述了这些服务在 4.4BSD 中的详细设计和实现。
